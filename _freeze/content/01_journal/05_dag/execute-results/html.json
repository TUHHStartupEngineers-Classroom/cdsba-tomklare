{
  "hash": "c3b725c73f9c8545a0dabfe8c4d33d45",
  "result": {
    "markdown": "---\ntitle: \"Directed Acyclic Graphs\"\n---\n\n\n\n## Parking spot DAG\n\n::: {.cell warnings='false' hash='05_dag_cache/html/unnamed-chunk-1_d2bc84662bee50caa1b968b96e6053fb'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dagitty)\nlibrary(ggdag)\n\n\ndag <- dagify(\n  parking_spots ~ location,\n  sales ~ location,\n  sales ~ parking_spots,\n  coords = list(x = c(parking_spots = 1, location = 2, sales = 3),\n                y = c(parking_spots = 1, location = 2, sales = 1))\n)\n\n# Plot DAG\nggdag(dag, text = F) +\n  geom_dag_point(color = \"blue\") +\n  geom_dag_text(color = NA) +\n  geom_dag_edges(edge_color = \"black\") +\n  geom_dag_label_repel(aes(label = name))\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n## Regression models\n\n::: {.cell warnings='false' hash='05_dag_cache/html/unnamed-chunk-2_989365dee062eb1a8f8b8ae41ebde213'}\n\n```{.r .cell-code}\ndf <- readRDS(\"./Causal_Data_Science_Data/customer_sat.rds\")\n\nlm <- lm(satisfaction ~ follow_ups, data = df)\nsummary(lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ follow_ups, data = df)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -12.412  -5.257   1.733   4.506  12.588 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  78.8860     4.2717  18.467 1.04e-10 ***\n#> follow_ups   -3.3093     0.6618  -5.001 0.000243 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 7.923 on 13 degrees of freedom\n#> Multiple R-squared:  0.658,\tAdjusted R-squared:  0.6316 \n#> F-statistic: 25.01 on 1 and 13 DF,  p-value: 0.0002427\n```\n:::\n\n```{.r .cell-code}\nlm_all <- lm(satisfaction ~ follow_ups + subscription, data = df)\nsummary(lm_all)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ follow_ups + subscription, data = df)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -4.3222 -2.1972  0.3167  2.2667  3.9944 \n#> \n#> Coefficients:\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)           26.7667     6.6804   4.007  0.00206 ** \n#> follow_ups             2.1944     0.7795   2.815  0.01682 *  \n#> subscriptionPremium   44.7222     5.6213   7.956 6.88e-06 ***\n#> subscriptionPremium+  18.0722     2.1659   8.344 4.37e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2.958 on 11 degrees of freedom\n#> Multiple R-squared:  0.9597,\tAdjusted R-squared:  0.9487 \n#> F-statistic: 87.21 on 3 and 11 DF,  p-value: 5.956e-08\n```\n:::\n:::\n\n\n## Explanation\nIn the first model the coefficient for follow ups is -3.3, which means that for every follow up call the satisfaction goes down.\nIn the second model the coefficient is 2.19, meaning the satisfaction goes up 2.19 points per follow up. \nThis makes more sense, as a follow up call is unlikely to decrease customer satisfaction. The reason for this is, that model 2 also takes subscriptions into account.\n\n## Plot data\n\n::: {.cell warnings='false' hash='05_dag_cache/html/unnamed-chunk-3_4a12bc75d3b976db465103e59e514a1a'}\n\n```{.r .cell-code}\ndata_not_cond <- ggplot(df, aes(x = follow_ups, y = satisfaction)) +\n  geom_point(alpha = .8) +\n  stat_smooth(method = \"lm\", se = F)\n\ndata_not_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell warnings='false' hash='05_dag_cache/html/unnamed-chunk-4_58d950ea64208e943d120f501e6a699a'}\n\n```{.r .cell-code}\n# Conditioning on subscription  \ndata_cond <- ggplot(df, aes(x = follow_ups, y = satisfaction, color = subscription)) +\n  geom_point(alpha = .8) +\n  stat_smooth(method = \"lm\", se = F) +\n  theme(legend.position = \"right\")\n\ndata_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}